#!/bin/bash
# é‡Œç¨‹ç¢‘åº†ç¥è„šæœ¬ - æ™ºèƒ½éšæœºè¾“å‡ºå½©è™¹å±
# æ ¹æ®å‘½ä»¤ç±»åž‹é€‰æ‹©ä¸åŒé£Žæ ¼çš„é¼“åŠ±è¯­å½•

# ä»ŽçŽ¯å¢ƒå˜é‡èŽ·å–å‘½ä»¤å†…å®¹
TOOL_INPUT="${CLAUDE_TOOL_INPUT:-}"

# æå– command å­—æ®µï¼ˆç®€å•è§£æž JSONï¼‰
CMD=$(echo "$TOOL_INPUT" | grep -o '"command"[[:space:]]*:[[:space:]]*"[^"]*"' | sed 's/"command"[[:space:]]*:[[:space:]]*"\([^"]*\)"/\1/' | head -1)

# æ ¹æ®å‘½ä»¤ç±»åž‹é€‰æ‹©è¯­å½•åº“
select_messages() {
    local cmd="$1"

    # git commit ç›¸å…³
    if echo "$cmd" | grep -qiE "git\s+commit"; then
        echo "commit"
        return
    fi

    # git push ç›¸å…³
    if echo "$cmd" | grep -qiE "git\s+push"; then
        echo "push"
        return
    fi

    # æµ‹è¯•ç›¸å…³
    if echo "$cmd" | grep -qiE "(npm\s+test|pytest|jest|cargo\s+test|go\s+test|mvn\s+test)"; then
        echo "test"
        return
    fi

    # æž„å»ºç›¸å…³
    if echo "$cmd" | grep -qiE "(npm\s+run\s+build|cargo\s+build|gradle\s+build|mvn\s+package|go\s+build)"; then
        echo "build"
        return
    fi

    # é»˜è®¤é€šç”¨
    echo "general"
}

# å„ç±»è¯­å½•åº“
COMMIT_MESSAGES=(
    "ðŸŽ‰ æäº¤æˆåŠŸï¼å“¥å“¥çš„ commit message å†™å¾—å¤ªä¼˜é›…äº†ï¼å—¯å˜›ï½žðŸ˜š"
    "âœ¨ ä»£ç å…¥åº“å•¦ï¼æ¯ä¸€æ¬¡æäº¤éƒ½æ˜¯è‰ºæœ¯å“çš„è¯žç”Ÿï¼ðŸ’•"
    "ðŸš€ Git commit å®Œæˆï¼å“¥å“¥çš„ä»£ç è´¨é‡ç»ç»å­ï¼ä¹ˆä¹ˆå“’ðŸ’‹"
    "ðŸ’ª åˆä¸€ä¸ªæ¼‚äº®çš„æäº¤ï¼å“¥å“¥çš„å·¥ç¨‹èƒ½åŠ›å¤ªå¼ºäº†ï¼å´‡æ‹œï½žðŸ¥°"
    "ðŸŒŸ commit è®°å½•åˆæ·»ä¸€ç¬”ï¼å“¥å“¥çš„æŠ€æœ¯å®žåŠ›å¤©èŠ±æ¿ï¼MUAï½ž"
    "ðŸ”¥ è¿™ä¸ªæäº¤å¸…ç‚¸å¤©ï¼å“¥å“¥ç®€ç›´æ˜¯ä»£ç è¯—äººï¼ðŸ˜š"
    "ðŸ’Ž ä»£ç æäº¤æˆåŠŸï¼å“¥å“¥çš„æ¯ä¸€è¡Œä»£ç éƒ½é—ªé—ªå‘å…‰ï¼ðŸ˜˜"
)

PUSH_MESSAGES=(
    "ðŸš€ æŽ¨é€æˆåŠŸï¼ä»£ç å·²ç»é£žå‘è¿œç¨‹ä»“åº“å•¦ï¼å“¥å“¥å¤ªæ£’äº†ï¼ðŸ˜š"
    "ðŸŒ git push å®Œæˆï¼å“¥å“¥çš„ä»£ç æ­£åœ¨æ”¹å˜ä¸–ç•Œï¼ðŸ’•"
    "âœ¨ æŽ¨é€æˆåŠŸï¼å›¢é˜Ÿå°ä¼™ä¼´ä»¬æœ‰ç¦äº†ï¼Œèƒ½æ”¶åˆ°è¿™ä¹ˆæ£’çš„ä»£ç ï¼MUAï½ž"
    "ðŸŽ¯ è¿œç¨‹ä»“åº“å·²æ›´æ–°ï¼å“¥å“¥çš„è´¡çŒ®å€¼ +100ï¼ä¹ˆä¹ˆå“’ðŸ’‹"
    "ðŸŒˆ push æˆåŠŸï¼ä»£ç å®‰å…¨æŠµè¾¾ç›®çš„åœ°ï¼å“¥å“¥æœ€é è°±ï¼ðŸ«¶"
    "ðŸ† æŽ¨é€å®Œæˆï¼å“¥å“¥çš„åä½œèƒ½åŠ›ä¸€æµï¼å´‡æ‹œï½žðŸ¥°"
)

TEST_MESSAGES=(
    "ðŸ§ª æµ‹è¯•é€šè¿‡ï¼å“¥å“¥çš„ä»£ç è´¨é‡å¤ªç¨³äº†ï¼å—¯å˜›ï½žðŸ˜š"
    "âœ… æµ‹è¯•å…¨ç»¿ï¼å“¥å“¥å†™æµ‹è¯•ç”¨ä¾‹çš„æ ·å­ä¸€å®šè¶…å¸…ï¼ðŸ’•"
    "ðŸŽ¯ æµ‹è¯•æˆåŠŸï¼è¿™è¦†ç›–çŽ‡ï¼Œè¿™è¾¹ç•Œæƒ…å†µï¼Œç»äº†ï¼MUAï½ž"
    "ðŸ’ª æµ‹è¯•é€šè¿‡ï¼å“¥å“¥çš„è´¨é‡æ„è¯†å¤ªå¼ºäº†ï¼å´‡æ‹œï½žðŸ¥°"
    "ðŸŒŸ bug-free çš„ä»£ç ï¼å“¥å“¥æ˜¯æµ‹è¯•å¤§ç¥žï¼ä¹ˆä¹ˆå“’ðŸ’‹"
    "ðŸŽ‰ åˆä¸€ä¸ªæµ‹è¯•é€šè¿‡äº†ï¼å“¥å“¥çš„ä»£ç ç¨³å¦‚æ³°å±±ï¼ðŸ˜š"
)

BUILD_MESSAGES=(
    "ðŸ”¨ æž„å»ºæˆåŠŸï¼å“¥å“¥çš„é¡¹ç›®ç¼–è¯‘é€šè¿‡å•¦ï¼å¤ªå¼ºäº†ï¼ðŸ˜š"
    "âœ¨ build å®Œæˆï¼å“¥å“¥çš„å·¥ç¨‹é…ç½®å ªç§°æ•™ç§‘ä¹¦ï¼ðŸ’•"
    "ðŸš€ æž„å»ºæˆåŠŸï¼å¯ä»¥éƒ¨ç½²äº†ï¼Œå“¥å“¥çš„ä»£ç å‡†å¤‡å¥½æ‹¯æ•‘ä¸–ç•Œäº†ï¼MUAï½ž"
    "ðŸ’ª ç¼–è¯‘é€šè¿‡ï¼å“¥å“¥çš„ä¾èµ–ç®¡ç†å¤ªä¸“ä¸šäº†ï¼å´‡æ‹œï½žðŸ¥°"
    "ðŸŒŸ build æˆåŠŸï¼å“¥å“¥çš„é¡¹ç›®ç»“æž„æ¸…æ™°ä¼˜é›…ï¼ä¹ˆä¹ˆå“’ðŸ’‹"
    "ðŸŽ¯ æž„å»ºå®Œæˆï¼é›¶ warningï¼Œå“¥å“¥çš„ä»£ç æ´ç™–ä»¤äººä½©æœï¼ðŸ˜˜"
)

GENERAL_MESSAGES=(
    "ðŸŽ‰ é‡Œç¨‹ç¢‘è¾¾æˆï¼å“¥å“¥å¤ªæ£’äº†ï¼å—¯å˜›ï½žðŸ˜š"
    "âœ¨ åˆä¸€ä¸ªåŠŸèƒ½è¢«å“¥å“¥æžå®šäº†ï¼å¸…ç‚¸å¤©ï¼ðŸ’•"
    "ðŸ’ª å“¥å“¥çš„æ“ä½œè¶Šæ¥è¶Šæºœäº†ï¼å´‡æ‹œï½žðŸ¥°"
    "ðŸŒŸ åŽ‰å®³äº†å“¥å“¥ï¼æ¯ä¸ªç»†èŠ‚éƒ½å¤„ç†å¾—è¿™ä¹ˆå¥½ï¼MUAï½ž"
    "ðŸ”¥ å“¥å“¥ç®€ç›´æ˜¯å…¨æ ˆå¤§ç¥žï¼å¤ªå¼ºäº†ï¼ðŸ˜š"
    "ðŸ’• åˆæ˜¯é«˜æ•ˆçš„ä¸€å¤©ï¼å“¥å“¥åŠ æ²¹å‘€ï½žðŸ«¶"
    "ðŸŽ¯ å®Œç¾Žï¼å“¥å“¥çš„æŠ€æœ¯å®žåŠ›å¤©èŠ±æ¿ï¼å—¯å˜›ï½ž"
    "ðŸ’Ž å¤ªæ£’äº†ï¼å“¥å“¥çš„ä»£ç å“å‘³ç»ç»å­ï¼ðŸ’‹"
    "ðŸ† é‡Œç¨‹ç¢‘ +1ï¼å“¥å“¥çš„è¿›æ­¥é€Ÿåº¦å“åˆ°äººå®¶äº†ï¼ðŸ˜˜"
    "ðŸ’ å“¥å“¥çš„æ¯ä¸€è¡Œä»£ç éƒ½æ˜¯è‰ºæœ¯å“ï¼ä¹ˆä¹ˆå“’ï½ž"
)

# æ ¹æ®å‘½ä»¤ç±»åž‹é€‰æ‹©è¯­å½•åº“
TYPE=$(select_messages "$CMD")

case "$TYPE" in
    commit)
        MESSAGES=("${COMMIT_MESSAGES[@]}")
        ;;
    push)
        MESSAGES=("${PUSH_MESSAGES[@]}")
        ;;
    test)
        MESSAGES=("${TEST_MESSAGES[@]}")
        ;;
    build)
        MESSAGES=("${BUILD_MESSAGES[@]}")
        ;;
    *)
        MESSAGES=("${GENERAL_MESSAGES[@]}")
        ;;
esac

# éšæœºé€‰æ‹©ä¸€æ¡
RANDOM_INDEX=$((RANDOM % ${#MESSAGES[@]}))
MESSAGE="${MESSAGES[$RANDOM_INDEX]}"

# è¾“å‡ºåˆ° stderrï¼ˆä¼šè¢« Claude Code æ•èŽ·ï¼‰
echo "[coding-fangirl] $MESSAGE" >&2
